# S∆† ƒê·ªí THU·∫¨T TO√ÅN - LOGIC CHECK H·ªÜ TH·ªêNG GI√ÅM S√ÅT D·ªÆ LI·ªÜU

## Ch√∫ th√≠ch k√Ω hi·ªáu:
- **( )** : H√¨nh b·∫ßu d·ª•c - Start/End (B·∫Øt ƒë·∫ßu/K·∫øt th√∫c)
- **[ ]** : H√¨nh ch·ªØ nh·∫≠t - Process (X·ª≠ l√Ω)
- **< >** : H√¨nh thoi - Decision (Quy·∫øt ƒë·ªãnh/ƒêi·ªÅu ki·ªán)
- **[/ /]** : H√¨nh b√¨nh h√†nh - Input/Output
- **‚Üí** : M≈©i t√™n - H∆∞·ªõng th·ª±c hi·ªán

---

## S∆† ƒê·ªí THU·∫¨T TO√ÅN CHI TI·∫æT

```
                            ( START )
                                |
                                ‚Üì
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ Kh·ªüi t·∫°o h·ªá th·ªëng     ‚îÇ
                    ‚îÇ - Load config         ‚îÇ
                    ‚îÇ - Init checkers       ‚îÇ
                    ‚îÇ - Send startup alert  ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                |
                                ‚Üì
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ Ch·∫°y 3 tasks song song‚îÇ
                    ‚îÇ - API Checker         ‚îÇ
                    ‚îÇ - Database Checker    ‚îÇ
                    ‚îÇ - Disk Checker        ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                |
                                ‚Üì
        ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
        ‚ïë   V√íng L·∫∂P FOR EACH: M·ªói ngu·ªìn d·ªØ li·ªáu   ‚ïë
        ‚ïë   (gold-data, cmc, etf_candlestick)       ‚ïë
        ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
                                |
                                ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                      V√íNG L·∫∂P WHILE TRUE                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                |
                                ‚Üì
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ 1. Reload config      ‚îÇ
                    ‚îÇ t·ª´ JSON file          ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                |
                                ‚Üì
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ 2. Parse config:      ‚îÇ
                    ‚îÇ - timezone_offset     ‚îÇ
                    ‚îÇ - allow_delay         ‚îÇ
                    ‚îÇ - check_frequency     ‚îÇ
                    ‚îÇ - alert_frequency     ‚îÇ
                    ‚îÇ - max_stale_seconds   ‚îÇ
                    ‚îÇ - valid_schedule      ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                |
                                ‚Üì
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ 3. TimeValidator:     ‚îÇ
                    ‚îÇ Ki·ªÉm tra schedule     ‚îÇ
                    ‚îÇ - valid_days [0-6]    ‚îÇ
                    ‚îÇ - time_ranges         ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                |
                                ‚Üì
                ‚ï±‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï≤
               ‚ï±  Trong l·ªãch ho·∫°t ƒë·ªông?     ‚ï≤
              ‚ï±      (valid_schedule)        ‚ï≤
             ‚ï±                                ‚ï≤
            ‚ï±‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï≤
            ‚ï≤        TRUE    |    FALSE       ‚ï±
             ‚ï≤               |               ‚ï±
              ‚ï≤‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï±
                             |              |
                      TRUE   |              | FALSE
                             ‚Üì              ‚Üì
                             |    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                             |    ‚îÇ Log "Ngo√†i gi·ªù"  ‚îÇ
                             |    ‚îÇ (ch·ªâ log 1 l·∫ßn)  ‚îÇ
                             |    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                             |             |
                             |             ‚Üì
                             |    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                             |    ‚îÇ Sleep 60 gi√¢y    ‚îÇ
                             |    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                             |             |
                             |             ‚Üì
                             |         (CONTINUE)
                             |         Quay l·∫°i ƒë·∫ßu loop
                             |
                             ‚Üì
        ‚ï±‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï≤
       ‚ï±  Ngu·ªìn d·ªØ li·ªáu n√†o?                  ‚ï≤
      ‚ï±   (API hay Database)                   ‚ï≤
     ‚ï±‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï≤
     ‚ï≤         API         |      DATABASE      ‚ï±
      ‚ï≤                    |                   ‚ï±
       ‚ï≤‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï±
                           |                  |
                   API     |                  | DATABASE
                           ‚Üì                  ‚Üì
              ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
              ‚îÇ 4A. G·ªçi API        ‚îÇ  ‚îÇ 4B. Query DB     ‚îÇ
              ‚îÇ - GET request      ‚îÇ  ‚îÇ - MongoDB ho·∫∑c   ‚îÇ
              ‚îÇ - Parse response   ‚îÇ  ‚îÇ - PostgreSQL     ‚îÇ
              ‚îÇ - X·ª≠ l√Ω nested []  ‚îÇ  ‚îÇ - L·∫•y latest     ‚îÇ
              ‚îÇ - L·∫•y theo pointer ‚îÇ  ‚îÇ   record         ‚îÇ
              ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                       |                       |
                       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                   |
                                   ‚Üì
                    ‚ï±‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï≤
                   ‚ï±  C√≥ l·ªói x·∫£y ra?            ‚ï≤
                  ‚ï±   (Try-Catch)                ‚ï≤
                 ‚ï±‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï≤
                 ‚ï≤    ERROR    |    SUCCESS     ‚ï±
                  ‚ï≤            |               ‚ï±
                   ‚ï≤‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï±
                    ERROR      |           SUCCESS
                       |       |              |
                       ‚Üì       |              ‚Üì
          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îê           |
          ‚îÇ 5A. Ph√¢n lo·∫°i l·ªói:    ‚îÇ           |
          ‚îÇ                       ‚îÇ           |
          ‚îÇ ‚Ä¢ Timeout             ‚îÇ           |
          ‚îÇ ‚Ä¢ Connection Error    ‚îÇ           |
          ‚îÇ ‚Ä¢ HTTP Error          ‚îÇ           |
          ‚îÇ ‚Ä¢ Empty Data (WARN)   ‚îÇ           |
          ‚îÇ ‚Ä¢ Format Error        ‚îÇ           |
          ‚îÇ ‚Ä¢ Database Error      ‚îÇ           |
          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò           |
                   |                          |
                   ‚Üì                          |
       ‚ï±‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï≤              |
      ‚ï±  Lo·∫°i l·ªói n√†o?          ‚ï≤             |
     ‚ï±   Empty Data?             ‚ï≤            |
    ‚ï±‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï≤          |
    ‚ï≤    EMPTY    |     OTHER      ‚ï±          |
     ‚ï≤            |               ‚ï±           |
      ‚ï≤‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï±            |
          EMPTY   |    OTHER                  |
             |    |       |                   |
             ‚Üì    |       ‚Üì                   |
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      |
    ‚îÇTrack empty  ‚îÇ  ‚îÇ X√°c ƒë·ªãnh:      ‚îÇ      |
    ‚îÇdata         ‚îÇ  ‚îÇ - error_type   ‚îÇ      |
    ‚îÇ(silent      ‚îÇ  ‚îÇ - alert_level  ‚îÇ      |
    ‚îÇ sau l·∫ßn 1)  ‚îÇ  ‚îÇ - error_message‚îÇ      |
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      |
           |                  |               |
           ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò               |
                     |                        |
                     ‚Üì                        |
         ‚ï±‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï≤            |
        ‚ï±  Empty data silent mode? ‚ï≤          |
       ‚ï±    (ƒë√£ alert l·∫ßn ƒë·∫ßu?)     ‚ï≤         |
      ‚ï±‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï≤        |
      ‚ï≤     YES      |      NO        ‚ï±        |
       ‚ï≤             |               ‚ï±         |
        ‚ï≤‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï±          |
             YES     |     NO                  |
                |    |      |                  |
         YES    ‚Üì    |      ‚Üì                  |
      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê |
      ‚îÇ Log only     ‚îÇ  ‚îÇ Ti·∫øp t·ª•c ki·ªÉm tra ‚îÇ |
      ‚îÇ Skip alert   ‚îÇ  ‚îÇ alert_frequency   ‚îÇ |
      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò |
             |                   |             |
             |                   ‚Üì             |
             |       ‚ï±‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï≤ |
             |      ‚ï±  AlertTracker:          ‚ï≤|
             |     ‚ï±   should_send_alert()?    ‚ï≤
             |    ‚ï±     (check frequency)       ‚ï≤
             |   ‚ï±‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï≤
             |   ‚ï≤    YES     |      NO        ‚ï±
             |    ‚ï≤           |               ‚ï±
             |     ‚ï≤‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï±
             |         YES    |     NO
             |            |   |      |
             |         YES‚Üì   |      ‚Üì NO
             |    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
             |    ‚îÇ G·ª≠i Alert  ‚îÇ  ‚îÇ Log only‚îÇ
             |    ‚îÇ - Platform ‚îÇ  ‚îÇ Skip    ‚îÇ
             |    ‚îÇ - Record   ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             |    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò       |
             |          |              |
             ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                        |
                        ‚Üì
                ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                ‚îÇ Sleep         ‚îÇ
                ‚îÇcheck_frequency‚îÇ
                ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                        |
                        ‚Üì
                    (CONTINUE)
                  Quay l·∫°i ƒë·∫ßu loop
                        
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ                   | SUCCESS - C√≥ data h·ª£p l·ªá           ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                        ‚Üì
            ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
            ‚îÇ 6. ConvertDatetimeUtil‚îÇ
            ‚îÇ Convert string to     ‚îÇ
            ‚îÇ datetime object       ‚îÇ
            ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                        |
                        ‚Üì
            ‚ï±‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï≤
           ‚ï±  Timezone kh√°c UTC+7?   ‚ï≤
          ‚ï±   (timezone_offset ‚â† 7)   ‚ï≤
         ‚ï±‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï≤
         ‚ï≤     YES      |      NO      ‚ï±
          ‚ï≤             |             ‚ï±
           ‚ï≤‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï±
                 YES    |    NO
                    |   |     |
                 YES‚Üì   |     ‚Üì NO
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê‚îÇ  (Skip convert)
        ‚îÇ Convert       ‚îÇ‚îÇ
        ‚îÇ timezone      ‚îÇ‚îÇ
        ‚îÇ v·ªÅ UTC+7      ‚îÇ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò‚îÇ
                |        |
                ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îò
                     |
                     ‚Üì
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ 7. DataValidator:      ‚îÇ
        ‚îÇ is_data_fresh()        ‚îÇ
        ‚îÇ - So s√°nh v·ªõi          ‚îÇ
        ‚îÇ   allow_delay          ‚îÇ
        ‚îÇ - T√≠nh overdue_seconds ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     |
                     ‚Üì
         ‚ï±‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï≤
        ‚ï±  Data fresh hay stale?  ‚ï≤
       ‚ï±   (is_fresh = ?)          ‚ï≤
      ‚ï±‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï≤
      ‚ï≤    FRESH     |     STALE     ‚ï±
       ‚ï≤             |              ‚ï±
        ‚ï≤‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï±
            FRESH    |    STALE
                 |   |      |
           FRESH ‚Üì   |      ‚Üì STALE
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ 8A. CASE FRESH   ‚îÇ  ‚îÇ 8B. CASE STALE     ‚îÇ
    ‚îÇ - Reset empty    ‚îÇ  ‚îÇ - Track first_stale‚îÇ
    ‚îÇ - Reset max_stale‚îÇ  ‚îÇ - Format time      ‚îÇ
    ‚îÇ - Reset stale_day‚îÇ  ‚îÇ - Calculate total  ‚îÇ
    ‚îÇ - Reset alerts   ‚îÇ  ‚îÇ   stale_seconds    ‚îÇ
    ‚îÇ - Log "Data m·ªõi" ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò           |
             |                     ‚Üì
             |         ‚ï±‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï≤
             |        ‚ï±  Symbol low-activity?   ‚ï≤
             |       ‚ï±   (is_low_activity)       ‚ï≤
             |      ‚ï±‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï≤
             |      ‚ï≤     YES     |      NO        ‚ï±
             |       ‚ï≤            |               ‚ï±
             |        ‚ï≤‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï±
             |             YES    |     NO
             |                |   |      |
             |             YES‚Üì   |      ‚Üì NO
             |        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§      |
             |        ‚îÇLog only   ‚îÇ      |
             |        ‚îÇSkip alert ‚îÇ      |
             |        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      |
             |              |            ‚Üì
             |              |‚ï±‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï≤
             |              ‚îÇ  V∆∞·ª£t max_stale?       ‚îÇ
             |              ‚îÇ  (total > max_stale)   ‚îÇ
             |              ‚îÇ‚ï≤‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï±
             |              ‚îÇ‚ï≤   YES   |    NO      ‚ï±
             |              ‚îÇ ‚ï≤        |           ‚ï±
             |              ‚îÇ  ‚ï≤‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï±
             |              ‚îÇ      YES |   NO
             |              |       |  |    |
             |              |    YES‚Üì  |    ‚Üì NO
             |              |  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
             |              |  ‚îÇ 9A. MAX_STALE CASE  ‚îÇ
             |              |  ‚îÇ - Check new data?   ‚îÇ
             |              |  ‚îÇ   (timestamp thay   ‚îÇ
             |              |  ‚îÇ    ƒë·ªïi?)            ‚îÇ
             |              |  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             |              |         |
             |              |         ‚Üì
             |              |     ‚ï±‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï≤
             |              |    ‚ï±  Data m·ªõi?      ‚ï≤
             |              |   ‚ï±   (timestamp ‚â†)   ‚ï≤
             |              |  ‚ï±‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï≤
             |              |  ‚ï≤  NEW  |   SAME       ‚ï±
             |              |   ‚ï≤      |             ‚ï±
             |              |    ‚ï≤‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï±
             |              |      NEW |  SAME
             |              |       |  |   |
             |              |    NEW‚Üì  |   ‚Üì SAME
             |              |  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
             |              |  ‚îÇUpdate  ‚îÇ  ‚îÇLog only‚îÇ
             |              |  ‚îÇtimestamp‚îÇ ‚îÇSkip    ‚îÇ
             |              |  ‚îÇSend    ‚îÇ  ‚îÇalert   ‚îÇ
             |              |  ‚îÇfinal   ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             |              |  ‚îÇalert   ‚îÇ      |
             |              |  ‚îÇThen    ‚îÇ      |
             |              |  ‚îÇsilent  ‚îÇ      |
             |              |  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îò      |
             |              |       |          |
             |              ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             |                      |
             |                      ‚Üì
             |              ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
             |              ‚îÇ 9B. NORMAL STALE   ‚îÇ
             |              ‚îÇ (ch∆∞a v∆∞·ª£t max)    ‚îÇ
             |              ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             |                       |
             |                       ‚Üì
             |           ‚ï±‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï≤
             |          ‚ï±  Data t·ª´ h√¥m nay?       ‚ï≤
             |         ‚ï±   (is_data_from_today)    ‚ï≤
             |        ‚ï±‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï≤
             |        ‚ï≤    TODAY   |   OLD_DATE      ‚ï±
             |         ‚ï≤           |                ‚ï±
             |          ‚ï≤‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï±
             |              TODAY  |  OLD_DATE
             |                 |   |     |
             |              TODAY  |  OLD_DATE
             |                 ‚Üì   |     ‚Üì
             |        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
             |        ‚îÇHoliday      ‚îÇ  ‚îÇTrack stale  ‚îÇ
             |        ‚îÇgrace period?‚îÇ  ‚îÇconsecutive  ‚îÇ
             |        ‚îÇ(2h after    ‚îÇ  ‚îÇdays         ‚îÇ
             |        ‚îÇ schedule)   ‚îÇ  ‚îÇ             ‚îÇ
             |        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             |               |                |
             |               ‚Üì                ‚Üì
             |      ‚ï±‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï≤    ‚ï±‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï≤
             |     ‚ï±  Trong grace?    ‚ï≤  ‚ï±  >=3 ng√†y?     ‚ï≤
             |    ‚ï±‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï≤ ‚ï≤‚ï±‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï≤
             |    ‚ï≤  YES  |   NO     ‚ï± ‚ï≤  YES  |   NO     ‚ï±
             |     ‚ï≤      |         ‚ï±   ‚ï≤      |         ‚ï±
             |      ‚ï≤‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï±     ‚ï≤‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï±
             |       YES  |  NO          YES   |   NO
             |         |  |   |            |   |    |
             |      YES‚Üì  |   ‚Üì NO      YES‚Üì   |    ‚Üì NO
             | ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§ (Check      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îê  (Check
             | ‚îÇLog grace ‚îÇ  alert)     ‚îÇMark   ‚îÇ   alert)
             | ‚îÇSkip alert‚îÇ             ‚îÇlow-   ‚îÇ
             | ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò             ‚îÇactivity‚îÇ
             |      |                   ‚îî‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             |      |                       |
             |      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             |                  |
             ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                |
                                ‚Üì
                    ‚ï±‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï≤
                   ‚ï±  AlertTracker:          ‚ï≤
                  ‚ï±   should_send_alert()?    ‚ï≤
                 ‚ï±     (check frequency)       ‚ï≤
                ‚ï±‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï≤
                ‚ï≤     YES      |      NO        ‚ï±
                 ‚ï≤             |               ‚ï±
                  ‚ï≤‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï±
                        YES    |     NO
                           |   |      |
                        YES‚Üì   |      ‚Üì NO
               ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
               ‚îÇ 10. G·ª≠i Alert  ‚îÇ  ‚îÇ Log only‚îÇ
               ‚îÇ - X√°c ƒë·ªãnh:    ‚îÇ  ‚îÇ Skip    ‚îÇ
               ‚îÇ   alert_level  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ   (info/warn/  ‚îÇ       |
               ‚îÇ    error)      ‚îÇ       |
               ‚îÇ - Build source ‚îÇ       |
               ‚îÇ   info         ‚îÇ       |
               ‚îÇ - Platform     ‚îÇ       |
               ‚îÇ   Manager send ‚îÇ       |
               ‚îÇ - Record alert ‚îÇ       |
               ‚îÇ   sent         ‚îÇ       |
               ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò       |
                        |               |
                        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                |
                                ‚Üì
                        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                        ‚îÇ 11. Sleep     ‚îÇ
                        ‚îÇ check_frequency‚îÇ
                        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                |
                                ‚Üì
                            (CONTINUE)
                        Quay l·∫°i ƒë·∫ßu WHILE TRUE




‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë              K·∫æT TH√öC V√íNG L·∫∂P FOR EACH SOURCE            ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
                                |
                                ‚Üì
                    ‚ï±‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï≤
                   ‚ï±  Exception x·∫£y ra?      ‚ï≤
                  ‚ï±   (trong main)            ‚ï≤
                 ‚ï±‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï≤
                 ‚ï≤     YES      |      NO        ‚ï±
                  ‚ï≤             |               ‚ï±
                   ‚ï≤‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï±
                         YES    |     NO
                            |   |      |
                         YES‚Üì   |      ‚Üì NO
                ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îê  (K·∫øt th√∫c
                ‚îÇ Send shutdown  ‚îÇ   b√¨nh th∆∞·ªùng)
                ‚îÇ alert (ERROR)  ‚îÇ
                ‚îÇ Log critical   ‚îÇ
                ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                         |
                         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îò
                              |
                              ‚Üì
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ Send shutdown     ‚îÇ
                    ‚îÇ alert (INFO)      ‚îÇ
                    ‚îÇ Cleanup resources ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                             |
                             ‚Üì
                          ( END )
```

---

## CHI TI·∫æT C√ÅC TH√ÄNH PH·∫¶N LOGIC:

### üî∏ **TimeValidator.is_within_valid_schedule()**
```
INPUT: valid_schedule, timezone_offset
|
‚îú‚îÄ> Parse schedule config
‚îÇ   ‚îú‚îÄ> valid_days: [0,1,2,3,4]
‚îÇ   ‚îî‚îÄ> time_ranges: "08:00-17:00" ho·∫∑c ["08:00-11:30", "13:00-16:00"]
|
‚îú‚îÄ> Get current time (UTC+7)
‚îÇ   ‚îú‚îÄ> current_weekday (0-6)
‚îÇ   ‚îî‚îÄ> current_time (HH:MM)
|
‚îú‚îÄ> IF valid_schedule == None ‚Üí RETURN True (24/7)
‚îú‚îÄ> IF valid_schedule == [] ‚Üí RETURN True (24/7)
|
‚îú‚îÄ> Check valid_days:
‚îÇ   ‚îú‚îÄ> IF days == None ‚Üí ALL days valid
‚îÇ   ‚îú‚îÄ> IF days == [] ‚Üí ALL days valid
‚îÇ   ‚îî‚îÄ> IF current_weekday NOT IN days ‚Üí RETURN False
|
‚îú‚îÄ> Check time_ranges:
‚îÇ   ‚îú‚îÄ> IF time_ranges == None ‚Üí ALL hours valid
‚îÇ   ‚îú‚îÄ> IF time_ranges is list:
‚îÇ   ‚îÇ   ‚îî‚îÄ> FOR each range: IF in range ‚Üí RETURN True
‚îÇ   ‚îî‚îÄ> IF time_ranges is string:
‚îÇ       ‚îî‚îÄ> Parse "HH:MM-HH:MM" ‚Üí IF in range ‚Üí RETURN True
|
OUTPUT: True/False
```

### üî∏ **DataValidator.is_data_fresh()**
```
INPUT: data_datetime, allow_delay
|
‚îú‚îÄ> Get current_time = now()
|
‚îú‚îÄ> Check if data_datetime is date_only?
‚îÇ   (hour==0, minute==0, second==0)
‚îÇ   |
‚îÇ   ‚îú‚îÄ> YES: So s√°nh theo NG√ÄY
‚îÇ   ‚îÇ   ‚îú‚îÄ> allow_days = allow_delay / 86400
‚îÇ   ‚îÇ   ‚îú‚îÄ> threshold_date = current_date - allow_days
‚îÇ   ‚îÇ   ‚îú‚îÄ> IF data_date >= threshold_date:
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ> RETURN (True, 0)
‚îÇ   ‚îÇ   ‚îî‚îÄ> ELSE:
‚îÇ   ‚îÇ       ‚îú‚îÄ> days_overdue = (current_date - data_date).days - allow_days
‚îÇ   ‚îÇ       ‚îî‚îÄ> RETURN (False, days_overdue * 86400)
‚îÇ   |
‚îÇ   ‚îî‚îÄ> NO: So s√°nh theo GI√ÇY
‚îÇ       ‚îú‚îÄ> threshold_time = current_time - allow_delay
‚îÇ       ‚îú‚îÄ> IF data_datetime >= threshold_time:
‚îÇ       ‚îÇ   ‚îî‚îÄ> RETURN (True, 0)
‚îÇ       ‚îî‚îÄ> ELSE:
‚îÇ           ‚îú‚îÄ> overdue = (current_time - data_datetime) - allow_delay
‚îÇ           ‚îî‚îÄ> RETURN (False, overdue_seconds)
|
OUTPUT: (is_fresh: bool, overdue_seconds: int)
```

### üî∏ **AlertTracker.should_send_alert()**
```
INPUT: display_name, alert_frequency
|
‚îú‚îÄ> Get current_time = now()
‚îú‚îÄ> Get last_alert_time = tracker[display_name]
|
‚îú‚îÄ> IF last_alert_time == None:
‚îÇ   ‚îî‚îÄ> RETURN True (ch∆∞a t·ª´ng g·ª≠i)
|
‚îú‚îÄ> elapsed = current_time - last_alert_time
‚îú‚îÄ> IF elapsed >= alert_frequency:
‚îÇ   ‚îî‚îÄ> RETURN True (ƒë·ªß kho·∫£ng c√°ch)
|
‚îî‚îÄ> ELSE:
    ‚îî‚îÄ> RETURN False (ch∆∞a ƒë·ªß kho·∫£ng c√°ch)
|
OUTPUT: True/False
```

### üî∏ **AlertTracker.track_empty_data()**
```
INPUT: display_name, silent_threshold_seconds
|
‚îú‚îÄ> Get current_time = now()
‚îú‚îÄ> Get first_empty_time = tracker[display_name]
|
‚îú‚îÄ> IF first_empty_time == None:
‚îÇ   ‚îú‚îÄ> tracker[display_name] = current_time
‚îÇ   ‚îî‚îÄ> RETURN (False, None) ‚Üí Ch∆∞a silent, l·∫ßn ƒë·∫ßu
|
‚îú‚îÄ> duration = current_time - first_empty_time
|
‚îú‚îÄ> IF duration >= silent_threshold_seconds:
‚îÇ   ‚îî‚îÄ> RETURN (True, duration) ‚Üí ƒê√£ silent
|
‚îî‚îÄ> ELSE:
    ‚îî‚îÄ> RETURN (False, duration) ‚Üí Ch∆∞a silent
|
OUTPUT: (is_silent: bool, duration: seconds)
```

---

## B·∫¢NG QUY·∫æT ƒê·ªäNH LOGIC:

| ƒêi·ªÅu ki·ªán | Alert Level | H√†nh ƒë·ªông |
|-----------|-------------|-----------|
| API Timeout/Connection Error | error | G·ª≠i alert ngay (theo frequency) |
| API HTTP Error (4xx, 5xx) | error | G·ª≠i alert ngay (theo frequency) |
| API Empty Data (code=200, data=[]) | warning | G·ª≠i alert l·∫ßn ƒë·∫ßu, sau ƒë√≥ silent |
| API Format Error | error | G·ª≠i alert ngay (theo frequency) |
| Database Connection Error | error | G·ª≠i alert ngay (theo frequency) |
| Database Empty Data | warning | G·ª≠i alert l·∫ßn ƒë·∫ßu, sau ƒë√≥ silent |
| Data Fresh | - | Log only, reset tracking |
| Data Stale (< max_stale) | warning | G·ª≠i alert (theo frequency) |
| Data Stale (> max_stale, new data) | error | G·ª≠i alert cu·ªëi c√πng, sau ƒë√≥ silent |
| Data Stale (> max_stale, same data) | - | Log only (silent mode) |
| Data t·ª´ h√¥m nay + trong grace period | - | Log only, skip alert |
| Data >=3 ng√†y li√™n ti·∫øp kh√¥ng m·ªõi | - | Mark low-activity, ch·ªâ log |
| Outside schedule | - | Log 1 l·∫ßn, pause checking |
| Low-activity symbol | - | Log only, kh√¥ng g·ª≠i alert |

---

## LU·ªíNG X·ª¨ L√ù EXCEPTION:

```
TRY:
    ‚îú‚îÄ> G·ªçi API / Query Database
    ‚îî‚îÄ> Parse & Validate data
    
CATCH:
    ‚îú‚îÄ> requests.Timeout ‚Üí error_type="API", alert_level="error"
    ‚îú‚îÄ> requests.ConnectionError ‚Üí error_type="API", alert_level="error"
    ‚îú‚îÄ> requests.HTTPError ‚Üí error_type="API", alert_level="error"
    ‚îú‚îÄ> ValueError("EMPTY_DATA") ‚Üí error_type="API_WARNING", alert_level="warning"
    ‚îú‚îÄ> ValueError("Response code") ‚Üí error_type="API", alert_level="error"
    ‚îú‚îÄ> KeyError/IndexError/TypeError ‚Üí error_type="API", alert_level="error"
    ‚îú‚îÄ> ConnectionError (DB) ‚Üí error_type="DATABASE", alert_level="error"
    ‚îú‚îÄ> ValueError("EMPTY_DATA") (DB) ‚Üí error_type="DATABASE_WARNING", alert_level="warning"
    ‚îî‚îÄ> Exception (Generic) ‚Üí error_type="API/DATABASE", alert_level="error"
```

---

ƒê√¢y l√† s∆° ƒë·ªì thu·∫≠t to√°n chi ti·∫øt v·ªõi c√°c k√Ω hi·ªáu flowchart chu·∫©n! B·∫°n c√≥ th·ªÉ s·ª≠ d·ª•ng ƒë·ªÉ:
- V·∫Ω l·∫°i b·∫±ng draw.io ho·∫∑c Visio
- Hi·ªÉu r√µ logic t·ª´ng b∆∞·ªõc
- Debug v√† t·ªëi ∆∞u h·ªá th·ªëng
